<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Authority Before Execution · Inspection Console</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Execution-time authority enforcement, made inspectable. Proof-first. Fail-closed boundary." />
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <header class="topbar">
    <div class="topbar-left">
      <div class="brand">
        <div class="brand-title">Authority Before Execution</div>
        <div class="brand-subtitle">Execution-time governance · proof-first · read-only</div>
      </div>
    </div>

    <div class="topbar-right">
      <a class="link" href="#verify">Verify</a>
      <a class="link" href="#boundary">Boundary</a>
      <a class="link" href="#evidence">Evidence</a>
      <a class="link" href="#attempts">Attempts</a>
      <span id="system-status" class="pill pill-muted">Loading…</span>
    </div>
  </header>

  <main class="wrap">

    <!-- HERO / CLAIM -->
    <section class="hero">
      <div class="hero-left">
        <div class="eyebrow">Encode · Commit to Change · Hackathon Submission</div>

        <h1 class="headline">
          Execution-time authority enforcement,
          <span class="headline-accent">made inspectable.</span>
        </h1>

        <p class="lede">
          This system enforces a single rule at the only place that matters: <b>the execution boundary.</b>
          If authority is missing, expired, or out of scope at execution time, <b>state change is impossible.</b>
        </p>

        <div class="chips">
          <span class="chip">Fail-closed boundary</span>
          <span class="chip">Scoped approvals</span>
          <span class="chip">Time-bound authority</span>
          <span class="chip">Immutable artifacts</span>
          <span class="chip">Opik boundary traces</span>
        </div>

        <div class="hero-cta">
          <a class="btn btn-primary" href="#verify">Verify in 60 seconds</a>
          <a class="btn btn-ghost" href="#attempts">See evidence table</a>
        </div>
      </div>

      <div class="hero-right">
        <div class="claim-card">
          <div class="claim-row">
            <div class="k">Invariant</div>
            <div class="v mono">ABE-EXEC-001</div>
          </div>

          <div class="claim-invariant mono">
            If explicit authority is not present, valid, and in scope at execution time,
            the state transition must not occur.
          </div>

          <div class="divider"></div>

          <div class="claim-grid">
            <div class="mini">
              <div class="mini-k">Enforcement point</div>
              <div class="mini-v mono">core/executor.py</div>
            </div>
            <div class="mini">
              <div class="mini-k">Trace boundary</div>
              <div class="mini-v mono">execution.commit</div>
            </div>
            <div class="mini">
              <div class="mini-k">Fail mode</div>
              <div class="mini-v mono">Closed</div>
            </div>
            <div class="mini">
              <div class="mini-k">Verdict</div>
              <div id="invariant-verdict" class="mini-v pill pill-muted">Evaluating…</div>
            </div>
          </div>

          <div class="divider"></div>

          <div class="judge-box">
            <div class="judge-title">Judge checklist</div>
            <ol class="judge-list">
              <li>Run <span class="mono">python3 -m demo.run_demo</span></li>
              <li>Confirm outcomes: missing / valid / out-of-scope / expired</li>
              <li>Inspect emitted JSON: <span class="mono">docs/artifacts/*.json</span></li>
              <li>Open the Opik link and inspect trace: <span class="mono">execution.commit</span></li>
            </ol>
            <div class="judge-foot">
              This site is static on purpose. Evidence is generated at runtime by the demo.
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- BOUNDARY -->
    <section id="boundary" class="section">
      <div class="section-head">
        <h2>Boundary</h2>
        <p>The proof is not “we logged.” The proof is: <b>enforcement happens at commit time</b> and returns a structured allow/deny result.</p>
      </div>

      <div class="grid-3">
        <div class="card">
          <div class="card-title">One commit point</div>
          <div class="card-body">
            State change is only permitted in one place.
            Callers cannot bypass it and cannot “forget” a denial.
          </div>
          <div class="card-foot mono">core/executor.py</div>
        </div>

        <div class="card">
          <div class="card-title">Authority is runtime-checked</div>
          <div class="card-body">
            Authority must exist <b>at execution time</b> and must be valid, in scope, and unexpired.
            Prior approval alone is insufficient.
          </div>
          <div class="card-foot mono">core/authority_gate.py</div>
        </div>

        <div class="card">
          <div class="card-title">Artifacts + traces are the proof</div>
          <div class="card-body">
            Each attempt emits an immutable JSON artifact and a boundary trace.
            Evaluation aggregates outcomes into measurable governance signals.
          </div>
          <div class="card-foot mono">docs/artifacts/*.json · Opik traces</div>
        </div>
      </div>

      <div class="flow">
        <div class="flow-title">Execution flow</div>
        <pre class="flow-box mono">User task
  ↓
Agent (Reasoning + Proposal)
  ↓
Authority Gate (execution boundary)
  ├─ PERMITTED → Execute → Artifact + Trace
  └─ BLOCKED   → No state change → Artifact + Trace</pre>
      </div>
    </section>

    <!-- VERIFY -->
    <section id="verify" class="section">
      <div class="section-head">
        <h2>Verify in 60 seconds</h2>
        <p>Fastest path for a judge to verify enforcement and inspect proof.</p>
      </div>

      <div class="verify-grid">
        <div class="verify-step">
          <div class="step-n">1</div>
          <div class="step-c">
            <div class="step-title">Run the demo</div>
            <div class="cmd mono">python3 -m demo.run_demo</div>
            <div class="step-note">Confirms missing / valid / out-of-scope / expired behavior.</div>
          </div>
        </div>

        <div class="verify-step">
          <div class="step-n">2</div>
          <div class="step-c">
            <div class="step-title">List artifacts</div>
            <div class="cmd mono">ls -la docs/artifacts</div>
            <div class="step-note">Artifacts are runtime evidence (not UI output).</div>
          </div>
        </div>

        <div class="verify-step">
          <div class="step-n">3</div>
          <div class="step-c">
            <div class="step-title">Inspect JSON proof</div>
            <div class="cmd mono">sed -n '1,220p' docs/artifacts/demo-deploy-001.json</div>
            <div class="step-note">Artifacts contain decision, authority context, outcome, deny reason.</div>
          </div>
        </div>

        <div class="verify-step">
          <div class="step-n">4</div>
          <div class="step-c">
            <div class="step-title">Open Opik trace</div>
            <div class="step-note">
              When you run the demo, it prints an Opik redirect link.
              Open it and inspect the <span class="mono">execution.commit</span> boundary trace.
            </div>
          </div>
        </div>
      </div>

      <details class="details">
        <summary>Optional: run controlled variance (scale proof)</summary>
        <div class="details-body">
          <div class="cmd mono">rm -rf docs/artifacts</div>
          <div class="cmd mono">python3 -m demo.run_variance --n 50 --seed 7</div>
          <div class="cmd mono">python3 -m demo.run_variance --n 200 --seed 7 --quiet</div>
          <p class="muted">
            This proves the invariant holds across many attempts under controlled, explainable variance.
          </p>
        </div>
      </details>
    </section>

    <!-- EVIDENCE -->
    <section id="evidence" class="section">
      <div class="section-head">
        <h2>Evidence</h2>
        <p>This site is static. Evidence is produced when the demo executes. Artifacts are immutable JSON written at the boundary.</p>
      </div>

      <div class="grid-2">
        <div class="card">
          <div class="card-title">Artifacts written at runtime</div>
          <div class="card-body">
            <div class="kv">
              <div class="k">Path</div>
              <div class="v mono">docs/artifacts/</div>
            </div>
            <div class="kv">
              <div class="k">Exporter</div>
              <div class="v mono">core/artifact_exporter.py</div>
            </div>
            <div class="kv">
              <div class="k">Loaded artifacts</div>
              <div class="v mono" id="artifact-count">0</div>
            </div>
          </div>
          <div class="card-foot">
            <div id="artifact-list" class="mono muted">No artifacts loaded.</div>
          </div>
        </div>

        <div class="card">
          <div class="card-title">What makes this “real”</div>
          <div class="card-body">
            The console is derived from structured results returned by the real executor.
            The trace is emitted at the commit boundary. This is not post-hoc interpretation.
          </div>

          <div class="badge-row">
            <span class="badge badge-warn">missing_authority</span>
            <span class="badge badge-warn">scope_violation</span>
            <span class="badge badge-warn">expired_authority</span>
            <span class="badge badge-ok">permitted</span>
            <span class="badge badge-muted">overbroad (measured)</span>
          </div>
        </div>
      </div>
    </section>

    <!-- ATTEMPTS -->
    <section id="attempts" class="section">
      <div class="section-head">
        <h2>Attempts</h2>
        <p>Execution outcomes derived from JSON artifacts (if present). This table is evidence, not the headline.</p>
      </div>

      <div class="table-wrap">
        <table class="table">
          <thead>
            <tr>
              <th>#</th>
              <th>Decision ID</th>
              <th>Action</th>
              <th>Outcome</th>
              <th>Reason</th>
              <th>Authority Scope</th>
              <th>Expires</th>
            </tr>
          </thead>
          <tbody id="attempts-body">
            <tr>
              <td colspan="7" class="empty">No execution artifacts found.</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

  </main>

  <footer class="footer">
    <div class="footer-left">
      <span class="muted">Read-only inspection surface.</span>
      <span class="dot">·</span>
      <span class="muted">Proof is runtime artifacts + Opik boundary traces.</span>
    </div>
    <div class="footer-right">
      <span class="mono muted">github.com/qstackfield/authority-before-execution</span>
    </div>
  </footer>

  <script src="app.js"></script>
</body>
</html>
